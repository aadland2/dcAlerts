
<!DOCTYPE html>
<meta charset="utf-8">
<style>
body {
  font-family: "Wire One";
  margin: auto;
  position: relative;
  padding: 20px;
  height: 100%;
}
 
form {
  position: absolute;
  right: 10px;
  top: 10px;
}
 
.node {
    border: solid 1px white;
    line-height: 0.95;
    overflow: hidden;
    position: absolute;
    border-radius: 6px;
    background-image: -webkit-linear-gradient(top, hsla(0,0%,100%,.3), hsla(0,0%,100%,0));
    background-image:    -moz-linear-gradient(top, hsla(0,0%,100%,.3), hsla(0,0%,100%,0));
    background-image:     -ms-linear-gradient(top, hsla(0,0%,100%,.3), hsla(0,0%,100%,0));
    background-image:      -o-linear-gradient(top, hsla(0,0%,100%,.3), hsla(0,0%,100%,0));
    background-image:         linear-gradient(top, hsla(0,0%,100%,.3), hsla(0,0%,100%,0)); 
    text-shadow: -1px -1px 2px hsla(0,0%,100%,0.25),
        -1px -1px 2px hsla(0,0%,100%,0.25),
        -1px 1px 2px hsla(0,0%,100%,0.25),
        1px -1px 2px hsla(0,0%,100%,0.25),
        -1px 0px 2px hsla(0,0%,100%,0.25),
        1px 0px 2px hsla(0,0%,100%,0.25);
}

.node div {
   padding: 6px 4%;
}


</style>
<body>
  
 
  <div id="textual"></div>
  <div id="visual"> </div>

</body>
<script src="static/js/d3.v3.min.js"></script>
<script>

var response_data = {"status": "OK", "totalTransactions": "2", "name": "tree", "language": "english", "url": "http://abcnews.go.com/International/el-salvador-murder-capital-world-gang-violence-life/story?id=39177963", "usage": "By accessing AlchemyAPI or using information generated by AlchemyAPI, you are agreeing to be bound by the AlchemyAPI Terms of Use: http://www.alchemyapi.com/company/terms.html", "children": [{"sentiment": {"mixed": "1", "score": "-0.357482", "type": "negative"}, "text": "El Salvador", "relevance": "0.827039", "type": "City", "size": "13"}, {"sentiment": {"score": "-0.453942", "type": "negative"}, "text": "El Salvador", "relevance": "0.374868", "type": "Person", "size": "1"}, {"sentiment": {"score": "-0.285076", "type": "negative"}, "disambiguated": {"website": "http://www.sansalvador.gob.sv/", "yago": "http://yago-knowledge.org/resource/San_Salvador", "geonames": "http://sws.geonames.org/3583361/", "freebase": "http://rdf.freebase.com/ns/m.0ftfw", "subType": [], "dbpedia": "http://dbpedia.org/resource/San_Salvador", "name": "San Salvador"}, "text": "San Salvador", "relevance": "0.350625", "type": "City", "size": "2"}, {"sentiment": {"type": "neutral"}, "disambiguated": {"website": "http://www.csj.gob.sv/", "freebase": "http://rdf.freebase.com/ns/m.06w4nj5", "dbpedia": "http://dbpedia.org/resource/Supreme_Court_of_El_Salvador", "name": "Supreme Court of El Salvador"}, "text": "Supreme Court of El Salvador", "relevance": "0.339972", "type": "Organization", "size": "1"}, {"sentiment": {"mixed": "1", "score": "-0.212016", "type": "negative"}, "disambiguated": {"website": "http://www.usa.gov/", "yago": "http://yago-knowledge.org/resource/United_States", "name": "United States", "freebase": "http://rdf.freebase.com/ns/m.09c7w0", "opencyc": "http://sw.opencyc.org/concept/Mx4rvVikKpwpEbGdrcN5Y29ycA", "subType": ["Location", "Region", "AdministrativeDivision", "GovernmentalJurisdiction", "FilmEditor"], "dbpedia": "http://dbpedia.org/resource/United_States", "ciaFactbook": "http://www4.wiwiss.fu-berlin.de/factbook/resource/United_States"}, "text": "U.S.", "relevance": "0.327893", "type": "Country", "size": "10"}, {"sentiment": {"score": "0.653073", "type": "positive"}, "text": "El Salvador", "relevance": "0.294616", "type": "Facility", "size": "1"}, {"sentiment": {"score": "-0.432344", "type": "negative"}, "text": "Murder", "relevance": "0.270193", "type": "Crime", "size": "4"}, {"sentiment": {"score": "-0.34286", "type": "negative"}, "text": "Eriselda", "relevance": "0.261399", "type": "Person", "size": "4"}, {"sentiment": {"score": "0.259408", "type": "positive"}, "text": "Nightline", "relevance": "0.239607", "type": "TelevisionShow", "size": "3"}, {"sentiment": {"score": "-0.661804", "type": "negative"}, "text": "El Salvadorian", "relevance": "0.219072", "type": "Organization", "size": "1"}, {"sentiment": {"type": "neutral"}, "disambiguated": {"website": "http://www.inml.mj.pt/", "yago": "http://yago-knowledge.org/resource/Instituto_Nacional_de_Medicina_Legal", "name": "Instituto Nacional de Medicina Legal", "freebase": "http://rdf.freebase.com/ns/m.03cpspp", "subType": ["Person"], "dbpedia": "http://dbpedia.org/resource/Instituto_Nacional_de_Medicina_Legal"}, "text": "Instituto de Medicina Legal", "relevance": "0.217175", "type": "Organization", "size": "1"}, {"sentiment": {"score": "-0.385458", "type": "negative"}, "text": "Alexis", "relevance": "0.203605", "type": "Person", "size": "2"}, {"sentiment": {"type": "neutral"}, "text": "Munisha Kailley", "relevance": "0.186456", "type": "Person", "size": "2"}, {"sentiment": {"score": "0.653073", "type": "positive"}, "text": "Clavo", "relevance": "0.181788", "type": "Person", "size": "2"}, {"sentiment": {"type": "neutral"}, "text": "Santiago", "relevance": "0.174616", "type": "Person", "size": "2"}, {"sentiment": {"type": "neutral"}, "disambiguated": {"website": "http://www.virginia.gov", "yago": "http://yago-knowledge.org/resource/Virginia", "name": "Virginia", "freebase": "http://rdf.freebase.com/ns/m.0f2wcp", "opencyc": "http://sw.opencyc.org/concept/Mx4rvViztZwpEbGdrcN5Y29ycA", "subType": ["Location", "PoliticalDistrict", "AdministrativeDivision", "GovernmentalJurisdiction", "USState"], "dbpedia": "http://dbpedia.org/resource/Virginia"}, "text": "Virginia", "relevance": "0.170805", "type": "StateOrCounty", "size": "1"}, {"sentiment": {"type": "neutral"}, "text": "Carlos", "relevance": "0.169096", "type": "Person", "size": "1"}, {"sentiment": {"type": "neutral"}, "text": "Roberto", "relevance": "0.165672", "type": "Person", "size": "1"}, {"sentiment": {"type": "neutral"}, "disambiguated": {"website": "http://www.reuters.com", "yago": "http://yago-knowledge.org/resource/Reuters", "name": "Reuters", "freebase": "http://rdf.freebase.com/ns/m.0ps53", "subType": [], "crunchbase": "http://www.crunchbase.com/company/reuters", "dbpedia": "http://dbpedia.org/resource/Reuters"}, "text": "Reuters", "relevance": "0.16385", "type": "Company", "size": "1"}, {"sentiment": {"type": "neutral"}, "disambiguated": {"website": "http://www.lacity.org/", "name": "Los Angeles", "freebase": "http://rdf.freebase.com/ns/m.030qb3t", "subType": ["GovernmentalJurisdiction", "OlympicBiddingCity", "OlympicHostCity", "PlaceWithNeighborhoods", "FilmScreeningVenue"], "dbpedia": "http://dbpedia.org/resource/Los_Angeles", "geo": "34.05 -118.25"}, "text": "Los Angeles", "relevance": "0.163718", "type": "City", "size": "1"}, {"sentiment": {"score": "-0.476001", "type": "negative"}, "text": "rape", "relevance": "0.162084", "type": "Crime", "size": "1"}, {"sentiment": {"type": "neutral"}, "text": "La Fosa", "relevance": "0.16199", "type": "City", "size": "1"}, {"sentiment": {"score": "-0.298798", "type": "negative"}, "text": "Francisco", "relevance": "0.160444", "type": "Person", "size": "2"}, {"sentiment": {"score": "-0.219321", "type": "negative"}, "text": "Attorney", "relevance": "0.159592", "type": "JobTitle", "size": "1"}, {"sentiment": {"type": "neutral"}, "text": "Carmen Ortiz", "relevance": "0.159272", "type": "Person", "size": "1"}, {"sentiment": {"type": "neutral"}, "text": "Instituto de Medicina Legal", "relevance": "0.158401", "type": "Facility", "size": "1"}, {"sentiment": {"type": "neutral"}, "text": "Canada", "relevance": "0.154833", "type": "Country", "size": "1"}, {"sentiment": {"type": "neutral"}, "disambiguated": {"website": "http://ca.gov", "yago": "http://yago-knowledge.org/resource/California", "name": "California", "freebase": "http://rdf.freebase.com/ns/m.01n7q", "opencyc": "http://sw.opencyc.org/concept/Mx4rvVj2upwpEbGdrcN5Y29ycA", "subType": ["Location", "PoliticalDistrict", "AdministrativeDivision", "Appellation", "GovernmentalJurisdiction", "USState", "WineRegion"], "dbpedia": "http://dbpedia.org/resource/California", "geo": "35.458606 -119.355165"}, "text": "California", "relevance": "0.153777", "type": "StateOrCounty", "size": "1"}, {"sentiment": {"score": "-0.219321", "type": "negative"}, "text": "District of Massachusetts", "relevance": "0.153602", "type": "Organization", "size": "1"}, {"sentiment": {"type": "neutral"}, "text": "Ana", "relevance": "0.146134", "type": "Person", "size": "1"}, {"sentiment": {"type": "neutral"}, "text": "civil war", "relevance": "0.143167", "type": "FieldTerminology", "size": "1"}, {"sentiment": {"score": "-0.257333", "type": "negative"}, "disambiguated": {"freebase": "http://rdf.freebase.com/ns/m.04zw24b", "dbpedia": "http://dbpedia.org/resource/The_Graveyard_(film)", "name": "The Graveyard (film)"}, "text": "The Graveyard", "relevance": "0.1399", "type": "Movie", "size": "1"}, {"sentiment": {"score": "-0.424157", "type": "negative"}, "text": "prostitution", "relevance": "0.132635", "type": "Crime", "size": "1"}, {"sentiment": {"type": "neutral"}, "text": "Miguel", "relevance": "0.131826", "type": "Person", "size": "1"}, {"sentiment": {"type": "neutral"}, "text": "drug dealing", "relevance": "0.131651", "type": "FieldTerminology", "size": "1"}, {"sentiment": {"score": "-0.503521", "type": "negative"}, "text": "extortion", "relevance": "0.126484", "type": "Crime", "size": "1"}, {"sentiment": {"score": "-0.411833", "type": "negative"}, "text": "human trafficking", "relevance": "0.126084", "type": "FieldTerminology", "size": "1"}, {"sentiment": {"type": "neutral"}, "text": "Isabel", "relevance": "0.124916", "type": "Person", "size": "1"}, {"sentiment": {"type": "neutral"}, "text": "gun running", "relevance": "0.117397", "type": "FieldTerminology", "size": "1"}, {"sentiment": {"type": "neutral"}, "text": "three months", "relevance": "0.117397", "type": "Quantity", "size": "1"}, {"sentiment": {"type": "neutral"}, "text": "1,500 miles", "relevance": "0.117397", "type": "Quantity", "size": "1"}, {"sentiment": {"type": "neutral"}, "text": "two months", "relevance": "0.117397", "type": "Quantity", "size": "1"}, {"sentiment": {"type": "neutral"}, "text": "12-year", "relevance": "0.117397", "type": "Quantity", "size": "1"}, {"sentiment": {"type": "neutral"}, "text": "15-year", "relevance": "0.117397", "type": "Quantity", "size": "1"}, {"sentiment": {"type": "neutral"}, "text": "17-year", "relevance": "0.117397", "type": "Quantity", "size": "1"}, {"sentiment": {"type": "neutral"}, "text": "23-year", "relevance": "0.117397", "type": "Quantity", "size": "1"}]};

var summary = {"sm_api_title": "In El Salvador, the Murder Capital of the World, Gang Violence Becomes a Way of Life", "sm_api_content": " Gang violence has turned the small central American country of El Salvador, roughly 1,500 miles south of the United States border, into the murder capital of the world. The country has a murder rate 22 times that of the U.S., though these gangs have active members in 46 states, according to U.S. authorities, because of a revolving door of illegal immigrants and deportation cases going back and forth across the border. The day of the funeral, the mayor got on the phone and seemed to call in a favor with one of the gang leaders, asking them to stand down. Now, he said he wants to sneak back into the States, in part to escape gang life, because he said he's tired of taking orders from higher gang leaders, most of whom are in prison but can still make a phone call to have someone killed. The gangs started in Los Angeles after residents fled north to escape El Salvador's 12-year-long civil war began in the late 1980's, which left 75,000 people dead. A 15-year-old boy named Francisco said he made the perilous journey to the U.S. alone at age 13, fleeing gang violence, and now lives in California.", "sm_api_limitation": "Waited 0 extra seconds due to API limited mode, 21 requests left to make for today.", "sm_api_character_count": "1168"}


d3.select("#textual")
        .selectAll("h1")
        .data([summary])
        .enter()
        .append('h1')
        .text(function(d){
          return d.sm_api_title;
        });

d3.select("#textual")
        .selectAll("p")
        .data([summary])
        .enter()
        .append("p")
        .text(function(d){
          return d.sm_api_content;
        });

var width = innerWidth-40,
    height = innerHeight-40,
    color = d3.scale.category20c()
                      .domain(["negative","positive","neutral"])
                      .range(["red","green","grey"]),
    div = d3.select("#visual").append("div")
       .style("position", "relative");

var treemap = d3.layout.treemap()
    .size([width, height])
    .sticky(true)
    .value(function(d) { return d.size; });
 
var node = div.datum(response_data).selectAll(".node")
      .data(treemap.nodes)
    .enter().append("div")
      .attr("class", "node")
      .call(position)
      .style("background-color", function(d) {
          return d.name == 'tree' ? '#fff' : color(d.sentiment.type); })
      .append('div')
      .style("font-size", function(d) {
          // compute font size based on sqrt(area)
          return Math.max(20, 0.18*Math.sqrt(d.area))+'px'; })
      .text(function(d) { return d.children ? null : d.text; })
      .on("click",function(d){
        window.open(d.disambiguated.dbpedia,'_blank');
        window.open(d.disambiguated.dbpedia);
      });
 
function position() {
  this.style("left", function(d) { return d.x + "px"; })
      .style("top", function(d) { return d.y + "px"; })
      .style("width", function(d) { return Math.max(0, d.dx - 1) + "px"; })
      .style("height", function(d) { return Math.max(0, d.dy - 1) + "px"; });
}



</script>